<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ADMIN PANEL</title>
<style>
body { background:#111; color:#fff; font-family:Arial; padding:20px; }
.box { background:#222; padding:15px; border-radius:10px; margin:10px 0; }
button { padding:10px 20px; margin:5px; border:none; cursor:pointer; }
.approve { background:#27ae60; color:#fff; }
.reject { background:#e74c3c; color:#fff; }
</style>
</head>
<body>

<h1>ADMIN PANEL</h1>

<h2>Đơn nạp chờ duyệt</h2>
<div id="nap"></div>

<h2>Đơn rút chờ duyệt</h2>
<div id="rut"></div>

<script>
async function load(){
    const res = await fetch("/api/admin/orders");
    const data = await res.json();

    document.getElementById("nap").innerHTML =
        data.deposits.map(o=>`
            <div class="box">
                <b>${o.user}</b> nạp <b>${o.amount}</b>đ (+${o.robux} Robux) <br>
                <button class="approve" onclick="appDep(${o.id})">DUYỆT</button>
                <button class="reject" onclick="rej(${o.id},'deposit')">XOÁ</button>
            </div>
        `).join("");

    document.getElementById("rut").innerHTML =
        data.withdraws.map(o=>`
            <div class="box">
                <b>${o.user}</b> rút <b>${o.robux}</b> Robux → ${o.to} <br>
                <button class="approve" onclick="appRut(${o.id})">DUYỆT</button>
                <button class="reject" onclick="rej(${o.id},'withdraw')">XOÁ</button>
            </div>
        `).join("");
}

async function appDep(id){
    await fetch("/api/admin/approve/deposit",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({id})
    });
    load();
}

async function appRut(id){
    await fetch("/api/admin/approve/withdraw",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({id})
    });
    load();
}

async function rej(id,type){
    await fetch("/api/admin/reject",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({id,type})
    });
    load();
}

load();
setInterval(load,3000);
</script>
</body>
</html>
