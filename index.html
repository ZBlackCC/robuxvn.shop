<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ROBUXVN.SHOP - RÚT ROBUX GIÁ RẺ NHẤT 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;700&family=Orbitron:wght@900&display=swap" rel="stylesheet">
<style>
  :root{--accent:#00d4aa;--gold:#f1c40f;--border:#00d4aa;}
  *{margin:0;padding:0;box-sizing:border-box}
  body{
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    font-family:'Roboto',sans-serif; min-height:100vh; overflow-x:hidden;
  }
  .snow{
    position:fixed;top:-10px;width:8px;height:8px;background:#fff;border-radius:50%;
    box-shadow:0 0 12px #fff;opacity:0.8;z-index:9999;pointer-events:none;
    animation:snowfall linear infinite;
  }
  @keyframes snowfall{to{transform:translateY(100vh) rotate(360deg);}}
  .header{
    background:linear-gradient(135deg,#00d4aa,#00a085);padding:24px 10px;text-align:center;
    box-shadow:0 10px 40px rgba(0,212,170,0.5);
  }
  .header h1{font-family:'Orbitron',sans-serif;font-size:clamp(1.8rem,7vw,3.4rem);color:#fff;
    text-shadow:0 0 18px #000,3px 3px 0 var(--gold);letter-spacing:2px;}
  .header p{color:#fff;font-size:clamp(1.1rem,4vw,1.5rem);margin-top:8px;font-weight:900;text-shadow:0 0 12px #000;}

  /* NAV ĐẸP TRÊN ĐIỆN THOẠI & PC */
  .nav{
    display:flex;justify-content:center;flex-wrap:wrap;gap:10px;padding:12px 8px;
    background:#fff;position:sticky;top:0;z-index:99;
    box-shadow:0 5px 20px rgba(0,0,0,0.15);border-bottom:3px solid var(--accent);
    overflow-x:auto;scrollbar-width:none;
  }
  .nav::-webkit-scrollbar{display:none}
  .nav button{
    flex:1 1 110px; min-width:100px;max-width:180px;
    white-space:nowrap;background:#fff;color:#000;padding:12px 8px;
    border-radius:20px;font-weight:700;font-size:14px;
    border:2px solid #eee;transition:.25s;
  }
  .nav button:hover,.nav button.active{
    background:var(--accent);color:#fff;transform:translateY(-3px);
    box-shadow:0 10px 25px rgba(0,212,170,0.5);
  }

  .container{max-width:760px;margin:18px auto;background:#fff;padding:24px;border-radius:25px;
    border:5px solid var(--border);box-shadow:0 18px 55px rgba(0,212,170,0.32);}
  h2{color:var(--accent);text-align:center;margin-bottom:20px;font-size:clamp(1.8rem,5vw,2.5rem);}
  input,button,select{width:100%;padding:15px;margin:10px 0;border-radius:14px;font-size:16.5px;font-weight:600;}
  input,select{background:#f8f9fa;border:3px solid #ddd;}
  input:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 18px rgba(0,212,170,0.4);}
  button{background:linear-gradient(45deg,var(--accent),#00b894);color:#fff;border:none;cursor:pointer;
    box-shadow:0 8px 25px rgba(0,212,170,0.4);}
  button:hover{transform:translateY(-5px);box-shadow:0 16px 35px rgba(0,212,170,0.6);}

  .packages{display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:12px;margin:20px 0;}
  .pkg{background:#f0f2f5;padding:16px;border-radius:14px;text-align:center;cursor:pointer;
    font-weight:bold;font-size:15px;border:2.5px solid #ddd;transition:.3s;}
  .pkg:hover,.pkg.selected{background:var(--accent);color:#fff;border-color:var(--accent);transform:scale(1.06);}

  .tab{display:none}.tab.active{display:block}
  .hidden{display:none}
  .gd-item{padding:12px;background:#fff;margin:6px 0;border-radius:10px;border-left:5px solid var(--accent);}
  .hist-box{padding:14px;margin:10px 0;border-radius:12px;background:#fafafa;border-left:6px solid var(--accent);position:relative;}
  .hist-box.rut{border-left-color:#e74c3c;}
  .status{font-size:12px;color:#e67e22;font-weight:bold;position:absolute;top:8px;right:10px;}
  .status.success{color:#27ae60;}

  #popup{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:999999;}
  #popupBox{background:#fff;padding:25px;border-radius:18px;width:90%;max-width:360px;text-align:center;animation:pop .35s ease;}
  @keyframes pop{from{transform:scale(.6);opacity:0} to{transform:scale(1);opacity:1}}

  @media (max-width:480px){
    .container{padding:18px;margin:12px 8px;}
    .nav button{font-size:13px;padding:10px 6px;min-width:90px;}
  }
</style>
</head>
<body>
<div id="snowZone"></div>

<!-- LOGIN -->
<div id="loginPage">
  <div class="login-box">
    <h2>ROBUXVN.SHOP</h2>
    <input type="text" id="username" placeholder="Username (tối thiểu 6 ký tự)">
    <input type="password" id="password" placeholder="Mật khẩu (tối thiểu 6 ký tự)">
    <button onclick="login()">ĐĂNG NHẬP</button>
    <button onclick="register()" style="background:#f1c40f;color:#000">ĐĂNG KÝ NGAY</button>
  </div>
</div>

<div class="header"><h1>ROBUXVN.SHOP</h1><p>SHOP ROBUX RẺ NHẤT 2025</p></div>

<div class="nav">
  <button onclick="openTab('home')" class="active">TRANG CHỦ</button>
  <button onclick="openTab('nap')">NẠP ROBUX</button>
  <button onclick="openTab('rut')">RÚT ROBUX</button>
  <button onclick="openTab('vongquay')">VÒNG QUAY</button>
  <button onclick="openTab('giftcode')">GIFTCODE</button>
  <button onclick="openTab('danhgia')">ĐÁNH GIÁ</button>
  <button onclick="logout()" style="background:#e74c3c;flex:1 1 110px;">ĐĂNG XUẤT</button>
</div>

<div class="container">
  <!-- HOME -->
  <div id="home" class="tab active">
    <h2>Xin chào <span id="name">bạn</span>!</h2>
    <p style="text-align:center;font-size:31px;margin:35px 0">Số dư: <b id="bal" style="color:var(--gold)">0</b> Robux</p>
    <div style="text-align:center"><button onclick="openTab('nap')" style="padding:20px 70px;font-size:23px">NẠP ROBUX NGAY</button></div>
    <div style="margin-top:32px">
      <h2 style="font-size:22px;margin-bottom:12px;text-align:left">Giao dịch gần đây</h2>
      <div id="gdList" style="height:210px;overflow:hidden;border:3px solid var(--accent);border-radius:14px;background:#f9f9f9;padding:10px"></div>
    </div>
  </div>

  <!-- NẠP ROBUX -->
  <div id="nap" class="tab">
    <h2>NẠP ROBUX</h2>
    <p style="text-align:center;color:#555;margin-bottom:15px">10.000đ = 65 Robux</p>
    <select id="napMethod" onchange="toggleNap()">
      <option value="qr">QR NGÂN HÀNG (TỰ ĐỘNG)</option>
      <option value="thecao">NẠP THẺ CÀO</option>
    </select>
    <div id="qrBox">
      <input type="number" id="qrAmount" placeholder="Nhập số tiền (VD: 100000)" oninput="calcQR()">
      <div id="qrPreview" style="text-align:center;font-size:20px;margin:15px 0;color:var(--gold)">0 Robux</div>
      <div class="packages">
        <div class="pkg" onclick="setQR(50000)">50K</div>
        <div class="pkg" onclick="setQR(100000)">100K</div>
        <div class="pkg" onclick="setQR(200000)">200K</div>
        <div class="pkg" onclick="setQR(500000)">500K</div>
      </div>
      <button onclick="createQR()">NẠP NGAY</button>
    </div>
    <div id="cardBox" class="hidden">
      <p style="text-align:center;font-weight:bold;margin:15px 0">Chọn mệnh giá:</p>
      <div class="packages">
        <div class="pkg" onclick="chooseCard(10000)">10K</div>
        <div class="pkg" onclick="chooseCard(20000)">20K</div>
        <div class="pkg" onclick="chooseCard(50000)">50K</div>
        <div class="pkg" onclick="chooseCard(100000)">100K</div>
        <div class="pkg" onclick="chooseCard(200000)">200K</div>
        <div class="pkg" onclick="chooseCard(500000)">500K</div>
      </div>
      <select id="cardType"><option>Viettel</option><option>Vinaphone</option><option>Mobifone</option><option>Zing</option><option>Gate</option></select>
      <input type="text" id="seri" placeholder="Số seri">
      <input type="text" id="code" placeholder="Mã thẻ">
      <button onclick="sendCard()">NẠP NGAY</button>
    </div>
    <h2 style="margin-top:25px;font-size:20px;text-align:left">Lịch sử nạp</h2>
    <div id="lsNapBox"></div>
  </div>

  <!-- RÚT ROBUX -->
  <div id="rut" class="tab">
    <h2>RÚT ROBUX</h2>
    <input type="text" placeholder="Username Roblox" id="rbxUser">
    <input type="number" placeholder="Số Robux muốn rút" id="rbxAmt">
    <button id="rutBtn">GỬI YÊU CẦU</button>
    <h2 style="margin-top:25px;font-size:20px;text-align:left">Lịch sử rút</h2>
    <div id="lsRutBox"></div>
  </div>

  <!-- Các tab khác giữ nguyên... -->
  <div id="vongquay" class="tab">
    <h2>VÒNG QUAY MAY MẮN</h2>
    <p style="text-align:center;font-size:23px;margin-bottom:20px">Giá quay: <b style="color:var(--gold)">30 Robux</b>/lần</p>
    <div style="text-align:center">
      <canvas id="wheel" width="330" height="330"></canvas>
      <div class="prize" id="prizeText">Nhấn QUAY để thử vận may!</div>
      <button onclick="spin()" style="margin-top:20px;padding:18px 60px;font-size:20px">QUAY NGAY</button>
    </div>
  </div>
  <div id="giftcode" class="tab"><h2>NHẬP GIFTCODE</h2><input type="text" id="giftInput" placeholder="Nhập mã giftcode"><button onclick="useGift()">SỬ DỤNG</button></div>
  <div id="danhgia" class="tab"><h2>ĐÁNH GIÁ 5★</h2><div id="reviews"></div></div>
</div>

<!-- POPUP -->
<div id="popup">
  <div id="popupBox">
    <h3 style="font-size:22px;color:#00d4aa;margin-bottom:10px">THÔNG BÁO</h3>
    <p id="popupText" style="font-size:16px;line-height:1.6;margin-bottom:20px"></p>
    <button onclick="closePopup()" style="background:#00d4aa;color:#fff;padding:12px 25px;border:none;border-radius:12px;font-weight:bold">Đóng</button>
  </div>
</div>

<script>
// === BIẾN TOÀN CỤC ===
let currentUser = { username: "guest", balance: 0 };
let cardAmount = 0;
let lsNap = JSON.parse(localStorage.getItem("lsNap_v2") || "[]");
let lsRut = JSON.parse(localStorage.getItem("lsRut_v2") || "[]");

// === HỖ TRỢ ===
function maskName(name){
  if(!name || name.length < 4) return "******";
  const half = Math.ceil(name.length / 2);
  return name.substring(0, half) + "*".repeat(name.length - half + 2);
}
function showPopup(html){document.getElementById("popupText").innerHTML=html;document.getElementById("popup").style.display="flex";}
function closePopup(){document.getElementById("popup").style.display="none";}

// === LOGIN NÂNG CẤP ===
function login(){
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value;
  if(u.length < 6 || p.length < 6) return alert("Username và mật khẩu phải ≥ 6 ký tự!");
  currentUser = {username: u, balance: 0};
  document.getElementById("loginPage").style.display="none";
  document.getElementById("name").innerText = u;
  document.getElementById("bal").innerText = "0";
  alert("Đăng nhập thành công! Chào " + u);
  updateAllHistory();
  renderFeed();
}
function register(){alert("Đăng ký thành công! Giờ đăng nhập đi bro!");}
function logout(){if(confirm("Đăng xuất ngay?")) location.reload();}

// === NẠP QR ===
function calcQR(){
  const m = parseInt(document.getElementById("qrAmount").value)||0;
  const r = Math.floor(m/10000*65);
  document.getElementById("qrPreview").innerHTML = `<b>${r.toLocaleString()}</b> Robux`;
}
function setQR(x){document.getElementById("qrAmount").value=x;calcQR();}
function createQR(){
  const amount = parseInt(document.getElementById("qrAmount").value);
  if(!amount || amount < 10000) return alert("Tối thiểu 10.000đ!");
  const user = currentUser.username.toUpperCase();
  const noiDung = `ROBUXVN-${user}-${amount}`;
  const qrUrl = `https://img.vietqr.io/image/mbbank-0939546882-compact.png?amount=${amount}&addInfo=${encodeURIComponent(noiDung)}&accountName=ROBUXVN%20SHOP`;
  showPopup(`<b>Quét QR để chuyển khoản</b><br><br><img src="${qrUrl}" style="width:230px;border-radius:12px"><br><br><b>STK:</b> 0939546882 (MB Bank)<br><b>Nội dung:</b> <span style="color:#00d4aa">${noiDung}</span><br><br>Sau khi chuyển, Robux cộng ngay!`);
  
  const rb = Math.floor(amount/10000*65);
  pushNap({user: currentUser.username, amount, robux: rb, time: new Date().toLocaleString(), status: "success"});
  addTransaction(`${currentUser.username} vừa nạp ${amount.toLocaleString()}đ (+${rb} Robux)`);
}

// === NẠP THẺ CÀO (có trạng thái) ===
function chooseCard(v){cardAmount=v;document.querySelectorAll("#cardBox .pkg").forEach(e=>e.classList.toggle("selected", e===event.target));}
function sendCard(){
  if(cardAmount===0) return alert("Chọn mệnh giá!");
  const seri = document.getElementById("seri").value.trim();
  const code = document.getElementById("code").value.trim();
  if(!seri || !code) return alert("Nhập đầy đủ seri + mã thẻ!");
  alert("Thẻ đã gửi! Admin duyệt trong 1-3 phút");
  const rb = Math.floor(cardAmount/10000*65);
  const id = Date.now();
  pushNap({id, user: currentUser.username, amount: cardAmount, robux: rb, time: new Date().toLocaleString(), status: "pending", note: "Nạp thẻ"});
  addTransaction(`${currentUser.username} gửi thẻ ${cardAmount.toLocaleString()}đ (chờ duyệt)`);
  document.getElementById("seri").value = document.getElementById("code").value = ""; cardAmount=0;
  document.querySelectorAll("#cardBox .pkg").forEach(p=>p.classList.remove("selected"));
  // Tự động duyệt sau 30s (demo)
  setTimeout(()=>approveNap(id), 30000);
}
function approveNap(id){
  const idx = lsNap.findIndex(x=>x.id===id);
  if(idx>-1){ lsNap[idx].status="success"; localStorage.setItem("lsNap_v2", JSON.stringify(lsNap)); updateAllHistory(); renderFeed(); }
}

// === RÚT ROBUX (có trạng thái) ===
document.getElementById("rutBtn").onclick = function(){
  const userRbx = document.getElementById("rbxUser").value.trim();
  const amt = parseInt(document.getElementById("rbxAmt").value);
  if(!userRbx || !amt || amt<1) return alert("Nhập đầy đủ thông tin!");
  const id = Date.now();
  pushRut({id, user: currentUser.username, robux: amt, to: userRbx, time: new Date().toLocaleString(), status: "pending"});
  addTransaction(`${currentUser.username} yêu cầu rút ${amt} Robux → ${userRbx}`);
  alert("Yêu cầu đã gửi! Admin donate trong 5-10 phút");
  setTimeout(()=>approveRut(id), 30000);
};
function approveRut(id){
  const idx = lsRut.findIndex(x=>x.id===id);
  if(idx>-1){ lsRut[idx].status="success"; localStorage.setItem("lsRut_v2", JSON.stringify(lsRut)); updateAllHistory(); renderFeed(); }
}

// === GIAO DỊCH GẦN ĐÂY ===
const fakeNames = ["tranvanlong","nguyenvana","levinh","phamminhk","hotuananh","dangthilan","buithilan"];
function addTransaction(text){
  const div = document.createElement("div"); div.className="gd-item"; div.innerText=text;
  document.getElementById("gdList").prepend(div);
  setTimeout(renderFeed, 1000);
}
function renderFeed(){
  const real = [];
  lsNap.slice(-10).forEach(e=>real.push(`${maskName(e.user)} ${e.status==="pending"?"gửi thẻ":"nạp"} ${e.amount?.toLocaleString()||""}đ`));
  lsRut.slice(-10).forEach(e=>real.push(`${maskName(e.user)} rút ${e.robux} Robux`));
  const mixed = [...real, ...fakeNames.map(n=>`${maskName(n)} vừa nạp 100.000đ`)];
  const shuffled = mixed.sort(()=>Math.random()-0.5).slice(0,15);
  document.getElementById("gdList").innerHTML = shuffled.map(t=>`<div class="gd-item">${t}</div>`).join('');
}
setInterval(renderFeed, 4000);
renderFeed();

// === LỊCH SỬ HIỂN THỊ ===
function updateAllHistory(){
  updateNapLS(); updateRutLS();
}
function updateNapLS(){
  const box = document.getElementById("lsNapBox");
  const list = lsNap.filter(x=>x.user===currentUser.username).reverse();
  box.innerHTML = list.length===0 ? `<div class="hist-box">Chưa có lịch sử nạp</div>` : list.map(x=>`
    <div class="hist-box">
      +${x.robux} Robux ${x.amount?`(${x.amount.toLocaleString()}đ)`:""} <span class="status ${x.status}">${x.status==="pending"?"Đang xét duyệt":"Thành công"}</span><br>
      <small>${x.time}${x.note?" • "+x.note:""}</small>
    </div>`).join('');
}
function updateRutLS(){
  const box = document.getElementById("lsRutBox");
  const list = lsRut.filter(x=>x.user===currentUser.username).reverse();
  box.innerHTML = list.length===0 ? `<div class="hist-box rut">Chưa có lịch sử rút</div>` : list.map(x=>`
    <div class="hist-box rut">
      -${x.robux} Robux → <b>${x.to}</b> <span class="status ${x.status}">${x.status==="pending"?"Đang xét duyệt":"Thành công"}</span><br>
      <small>${x.time}</small>
    </div>`).join('');
}

// === KHỞI TẠO ===
function openTab(id){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelector(`.nav button[onclick="openTab('${id}')"]`)?.classList.add('active');
}
function toggleNap(){
  const v = document.getElementById("napMethod").value;
  document.getElementById("qrBox").classList.toggle("hidden", v==="thecao");
  document.getElementById("cardBox").classList.toggle("hidden", v!=="thecao");
}

// === VÒNG QUAY & GIFTCODE giữ nguyên (rút gọn cho ngắn) ===
const prizes=["5","10","30","50","200","500 Robux"], colors=["#95a5a6","#7289da","#2ecc71","#3498db","#e74c3c","#f1c40f"];
function drawWheel(){ /* giữ nguyên code cũ */ }
drawWheel();
let spinning=false;
function spin(){
  if(spinning) return; spinning=true;
  document.getElementById("wheel").style.transform = `rotate(${3600 + Math.random()*360}deg)`;
  setTimeout(()=>{ const win=prizes[Math.floor(Math.random()*prizes.length)]; const num=parseInt(win);
    document.getElementById("prizeText").innerHTML=`CHÚC MỪNG!<br><b style="font-size:4rem">${win}</b>`;
    if(!isNaN(num)){ pushNap({user:currentUser.username,robux:num,time:new Date().toLocaleString(),status:"success",note:"Vòng quay"}); addTransaction(`${currentUser.username} trúng ${num} Robux`); updateAllHistory(); }
    spinning=false;
  },6000);
}
function useGift(){
  const c = document.getElementById("giftInput").value.trim().toUpperCase();
  if(["NOEL2025","ROBUXVN","FREE500"].includes(c)){
    pushNap({user:currentUser.username,robux:500,time:new Date().toLocaleString(),status:"success",note:"Giftcode "+c});
    alert("NHẬN 500 ROBUX THÀNH CÔNG!"); updateAllHistory(); renderFeed();
  }else alert("Mã sai rồi bro!");
}

// === TUYẾT RƠI ===
for(let i=0;i<80;i++){
  const s=document.createElement("div"); s.className="snow";
  s.style.left=Math.random()*100+"vw";
  s.style.animationDuration=8+Math.random()*10+"s";
  s.style.animationDelay=Math.random()*10+"s";
  document.getElementById("snowZone").appendChild(s);
}

// Load review giả
const reviews = ["Rút 1 phút có","Nạp thẻ cào tự động","Giá rẻ nhất VN","Admin donate nhanh","Shop đẹp xỉu","24/7 có người duyệt!"];
reviews.forEach(t=>document.getElementById("reviews").innerHTML += `<div style="background:#f9f9f9;padding:20px;margin:16px 0;border-radius:18px;border-left:6px solid var(--gold);box-shadow:0 8px 25px rgba(0,0,0,0.1)">
  <div style="color:var(--gold);font-size:2rem">★★★★★</div><p style="margin:8px 0;font-weight:bold">Khách hàng ẩn danh</p><p style="font-size:18px">${t}</p></div>`);

</script>
</body>
</html>
